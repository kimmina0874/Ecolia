<!DOCTYPE html>
<html>
<head>
	<title>🌍 Ecolia 세계 시뮬레이션</title>
	<style>
		body {
			font-family: 'Courier New', monospace;
			background: #1e1e1e;
			color: #eee;
			padding: 20px;
			display: flex;
			flex-direction: row;
			gap: 20px;
		}
		.panel {
			flex: 1;
			background: #2e2e2e;
			border: 1px solid #444;
			padding: 15px;
			border-radius: 8px;
			overflow-y: auto;
			height: 85vh;
		}
		h2 {
			margin-top: 0;
			font-size: 1.2rem;
			border-bottom: 1px dashed #555;
			padding-bottom: 4px;
		}
		.log-line {
			margin-bottom: 4px;
			white-space: pre-line;
		}
		.agent {
			margin-bottom: 12px;
			padding-bottom: 8px;
			border-bottom: 1px dashed #666;
		}
		.agent strong {
			color: #ffd369;
		}
	</style>
</head>
<body>

	<div class="panel" id="log-panel">
		<h2>📜 실시간 행동 로그</h2>
		<div id="log">[Loading logs...]</div>
	</div>

	<div class="panel" id="agent-panel">
		<h2>🧍 AI 상태 모니터링</h2>
		<div id="agents">[Loading agents...]</div>
	</div>

	<script>
		const logBox = document.getElementById("log");
		const agentsBox = document.getElementById("agents");

		async function fetchLogs() {
			try {
				const res = await fetch("/api/logs");
				const data = await res.json();
				const html = data.logs.map(line => `<div class="log-line">${line}</div>`).join("");
				logBox.innerHTML = html;
				logBox.scrollTop = logBox.scrollHeight;
			} catch (e) {
				logBox.innerHTML = "<i>Failed to load logs.</i>";
			}
		}

		async function fetchAgents() {
			try {
				const res = await fetch("/api/agents");
				const data = await res.json();
				const html = data.agents.map(agent => `
					<div class="agent">
						<strong>${agent.name}</strong> (${agent.age}세)<br>
						🍽️ 배고픔: ${agent.hunger} | 💤 수면: ${agent.sleepiness || 0}<br>
						🧠 현재 행동: <strong>${agent.task}</strong><br>
						📦 인벤토리: ${Object.entries(agent.inventory).map(([k,v]) => `${k}: ${v}`).join(', ')}
					</div>
				`).join("");
				agentsBox.innerHTML = html;
			} catch (e) {
				agentsBox.innerHTML = "<i>Failed to load agents.</i>";
			}
		}

		setInterval(fetchLogs, 1000);
		setInterval(fetchAgents, 1500);
	</script>

</body>
</html>
